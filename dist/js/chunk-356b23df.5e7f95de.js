(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-356b23df"],{"0388":function(e,s,t){},2728:function(e,s,t){"use strict";t.r(s);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"user-settings"}},[t("div",{staticClass:"Map"},[t("router-link",{attrs:{id:"link",to:"/"}},[e._v("Kovid")])],1),t("div",{staticClass:"signin-signup"},[t("BusinessSignIn"),t("BusinessSignUp")],1),e.success.length?t("div",{staticClass:"success-message",staticStyle:{"text-align":"center"}},e._l(e.success,(function(s){return t("div",{key:s.id},[e._v(e._s(s))])})),0):e._e(),e.errors.length?t("div",{staticClass:"error-message",staticStyle:{width:"250px"}},[t("b",[e._v("Please correct the following error(s):")]),t("ul",e._l(e.errors,(function(s){return t("li",{key:s.id},[e._v(e._s(s))])})),0)]):e._e()])},r=[],a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"signup"},[t("form",{staticClass:"component",attrs:{id:"sign-up",method:"post"},on:{submit:function(s){return s.preventDefault(),e.validate(s)}}},[t("div",{staticClass:"header"},[e._v(" Sign Up ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.username,expression:"username",modifiers:{trim:!0}}],attrs:{id:"username",type:"text",name:"username",placeholder:"User's name"},domProps:{value:e.username},on:{input:function(s){s.target.composing||(e.username=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.password,expression:"password",modifiers:{trim:!0}}],attrs:{id:"password",type:"text",name:"password",placeholder:"User's password"},domProps:{value:e.password},on:{input:function(s){s.target.composing||(e.password=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.businessName,expression:"businessName",modifiers:{trim:!0}}],attrs:{id:"businessName",type:"text",name:"businessName",placeholder:"Business name"},domProps:{value:e.businessName},on:{input:function(s){s.target.composing||(e.businessName=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.address,expression:"address",modifiers:{trim:!0}}],attrs:{id:"address",type:"text",name:"address",placeholder:"Business address"},domProps:{value:e.address},on:{input:function(s){s.target.composing||(e.address=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{staticClass:"button",attrs:{type:"submit",value:"Sign Up"}})])])},i=[],o=t("bc3a"),u=t.n(o),c=t("56d7"),d={name:"BusinessSignUp",data:function(){return{username:"",password:"",businessName:"",address:""}},created:function(){var e=this;c["eventBus"].$on("validate-success",(function(s){var t={username:e.username,password:e.password,businessName:e.businessName,address:e.address,status:s[0].status,modification:s[0].modification};u.a.post("/api/business",t).then((function(){c["eventBus"].$emit("business-signup-success",!0)})).catch((function(e){c["eventBus"].$emit("business-signup-error",e.response.data.error)}))}))},methods:{validate:function(){var e=this;u.a.get("https://data.cambridgema.gov/resource/9q33-qjp4.json?name=".concat(this.businessName,"&$$app_token=ERObVliHkBTapyjk2U0736EEU")).then((function(s){0===s.data.length?c["eventBus"].$emit("business-signup-error","According to the government database, the entered business does not exist."):s.data.map((function(e){return e.phone})).filter((function(s){return s===e.address})).length>0?c["eventBus"].$emit("validate-success",s.data.filter((function(s){return s.phone===e.address}))):c["eventBus"].$emit("business-signup-error","According to the government database, the entered address does not match the business.")})).catch((function(){c["eventBus"].$emit("business-signup-error","trouble connecting to Cambridge government database."),e.errors.push("trouble connecting to Cambridge government database.")})).then((function(){e.resetForm()}))},resetForm:function(){this.username="",this.password="",this.businessName="",this.address=""},clearMessages:function(){var e=this;setInterval((function(){e.errors=[]}),5e3)}}},m=d,p=(t("b7d7"),t("2877")),l=Object(p["a"])(m,a,i,!1,null,"ffae36f4",null),f=l.exports,v=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"signin"},[t("form",{staticClass:"component",attrs:{id:"sign-in",method:"post"},on:{submit:function(s){return s.preventDefault(),e.signin(s)}}},[t("div",{staticClass:"header"},[e._v(" Sign In ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.username,expression:"username",modifiers:{trim:!0}}],attrs:{id:"username",type:"text",name:"username",placeholder:"User's name"},domProps:{value:e.username},on:{input:function(s){s.target.composing||(e.username=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.password,expression:"password",modifiers:{trim:!0}}],attrs:{id:"password",type:"text",name:"password",placeholder:"User's password"},domProps:{value:e.password},on:{input:function(s){s.target.composing||(e.password=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("input",{staticClass:"button",attrs:{type:"submit",value:"Sign In"}})])])},g=[],b=(t("7f7f"),{name:"BusinessSignIn",data:function(){return{username:"",password:""}},created:function(){},methods:{signin:function(){var e=this,s={username:this.username,password:this.password};u.a.post("/api/business/signin",s).then((function(e){console.log(e.data.name,e.data.bNam,e.data.bAdd),c["eventBus"].$emit("business-signin-success",e.data.name,e.data.bName,e.data.bAdd)})).catch((function(e){c["eventBus"].$emit("business-signin-error",e.response.data.error)})).then((function(){e.resetForm()}))},resetForm:function(){this.username="",this.password=""},clearMessages:function(){var e=this;setInterval((function(){e.errors=[]}),5e3)}}}),h=b,w=(t("5af8"),Object(p["a"])(h,v,g,!1,null,"591c70ac",null)),$=w.exports,B={name:"BusinessAccount",components:{BusinessSignUp:f,BusinessSignIn:$},data:function(){return{success:[],errors:[]}},created:function(){var e=this;c["eventBus"].$on("business-signup-success",(function(){e.success.push("Signup completed successfully."),e.clearMessages()})),c["eventBus"].$on("business-signup-error",(function(s){e.errors.push(s),e.clearMessages()})),c["eventBus"].$on("business-signin-success",(function(s,t,n){e.$cookie.set("auth",s),e.$cookie.set("account-type","business"),e.$cookie.set("bName",t["businessname"]),e.$cookie.set("bAdd",n["address"]),e.success.push("Successfully signed in as ".concat(s,".")),"/"!=e.$router.path&&e.$router.push("/").catch((function(){})),e.clearMessages()})),c["eventBus"].$on("business-signin-error",(function(s){e.errors.push(s),e.clearMessages()})),c["eventBus"].$on("business-signout-error",(function(s){e.errors.push(s),e.clearMessages()}))},methods:{clearMessages:function(){var e=this;setInterval((function(){e.success=[],e.errors=[]}),5e3)}}},N=B,_=(t("48bd"),Object(p["a"])(N,n,r,!1,null,"f8f6c62a",null));s["default"]=_.exports},"3cb1":function(e,s,t){},"48bd":function(e,s,t){"use strict";var n=t("3cb1"),r=t.n(n);r.a},"5af8":function(e,s,t){"use strict";var n=t("0388"),r=t.n(n);r.a},"7f7f":function(e,s,t){var n=t("86cc").f,r=Function.prototype,a=/^\s*function ([^ (]*)/,i="name";i in r||t("9e1e")&&n(r,i,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},a153:function(e,s,t){},b7d7:function(e,s,t){"use strict";var n=t("a153"),r=t.n(n);r.a}}]);
//# sourceMappingURL=chunk-356b23df.5e7f95de.js.map